{"id":"claude-dashboard-6dn","title":"feat: per-project MCP config onboarding for agent mail","description":"## Overview\n\nCurrently, mcp_agent_mail is configured globally in ~/.claude/mcp.json and all sessions inherit it. This is fine for single-user setups but doesn't allow per-project customization (different server ports, project-specific agent mail instances, team repos with shared server URLs).\n\n## Goal\n\nOne-time project onboarding flow that scaffolds a per-project .mcp.json in the session working directory, scoped to that repo.\n\n## What This Enables\n- Multiple mcp_agent_mail instances (e.g. one per team/repo)\n- Project-specific server URL (not just localhost:8765)\n- Checked into the repo so all contributors get the same config\n- Overrides global config for that project\n\n## Implementation Ideas\n- 'claude-dashboard setup' or 'claude-dashboard init' command for a project\n- Or a TUI flow triggered when creating a session with --new-env\n- Writes .mcp.json to the project root with mcp_agent_mail server config\n\n## Dependencies\n- Depends on claude-dashboard-hpy (global MCP config integration) being stable first\n\n## Context\nDeferred from claude-dashboard-hpy open question #2. Global config is sufficient for initial packaging goal.","status":"open","priority":3,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T12:49:29Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T12:49:29Z","dependencies":[{"issue_id":"claude-dashboard-6dn","depends_on_id":"claude-dashboard-hpy","type":"blocks","created_at":"2026-02-21T18:19:31Z","created_by":"Lakshmi Narasimhan","metadata":"{}"}]}
{"id":"claude-dashboard-6er","title":"ux: instant session search by typing","description":"## Overview\n\nCurrently, filtering sessions requires pressing `/` first to enter filter mode, then typing. This UX bead proposes **instant search** ‚Äî typing any alphanumeric character from the dashboard immediately starts filtering, no `/` prefix required.\n\n---\n\n## Current Behavior\n1. User presses `/` ‚Üí enters filter mode\n2. User types query ‚Üí sessions filtered\n3. User presses `esc` ‚Üí clears filter, exits filter mode\n\n## Proposed Behavior\n1. User types any letter/number from the dashboard ‚Üí instantly starts filtering\n2. Sessions update in real time as user types\n3. `backspace` removes last character\n4. `esc` clears filter and returns to normal\n5. `/` still works as before (for muscle memory compatibility)\n\n---\n\n## Search Fields\nSearch matches across all session fields:\n- Session name (e.g. `cd-gw-backend`)\n- Project name (e.g. `gw-backend`)\n- Status (e.g. `idle`, `active`, `waiting`)\n- Path (e.g. `/Users/lakshminp/growthwriter/gw-backend`)\n- Agent name (future, from claude-dashboard-ihq)\n\n---\n\n## UX Details\n\n### Search indicator\nShow a live search bar at the bottom when filtering is active:\n```\n  üîç gw-back         ‚Üê appears as user types\n```\n\n### Key conflicts to resolve\nSome single keys are already bound in dashboard:\n- `j`, `k` ‚Äî navigation (up/down)\n- `n` ‚Äî new session\n- `K` ‚Äî kill session\n- `l` ‚Äî logs\n- `d` ‚Äî detail\n- `r` ‚Äî refresh\n- `q` ‚Äî quit\n\n**Proposed rule**: reserved single-key actions remain. Typing starts search only for keys NOT bound to an action. Alternatively, require `/` as the trigger but make it feel instant (auto-focus the search bar). This avoids all conflicts.\n\n**Recommended approach**: Keep `/` as the trigger but remove the two-step feel ‚Äî as soon as `/` is pressed, the search bar appears and the cursor is immediately in it. No separate 'enter filter mode' feel. Make it feel like Spotlight or browser address bar.\n\n### Empty result state\n```\n  No sessions match 'xyz'\n```\n\n---\n\n## Implementation Notes\n\n- Filter logic already exists in `session.FilterSessions()` and `m.filterQuery`\n- Main change is in `handleDashboardKey` ‚Äî catch alphanumeric keys as search triggers\n- Or enhance the `/` flow to feel more instant (auto-ready textinput)\n- Filter bar rendering already in `View()` ‚Äî just needs to activate sooner\n\n---\n\n## Acceptance Criteria\n- [ ] Typing from dashboard immediately filters sessions\n- [ ] All fields (name, project, status, path) are searched\n- [ ] Filter bar visible while filtering with current query shown\n- [ ] `esc` clears filter\n- [ ] No conflict with existing single-key bindings\n- [ ] Empty state message shown when no results","status":"open","priority":2,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T10:35:58Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T10:35:58Z"}
{"id":"claude-dashboard-71j","title":"decision: agent-to-agent communication architecture","description":"## Context\n\nclaude-dashboard manages multiple AI coding agent sessions (Claude, Codex, Aider) in tmux. As the number of sessions grows, genuine coordination use cases emerge:\n- Orchestrator/worker task delegation\n- Parallel frontend + backend agents agreeing on API contracts\n- Write ‚Üí review ‚Üí iterate pipelines\n- Multi-repo changes spanning multiple sessions\n\nThe core problem: **there is no way to inject a message into a running agent**. Agents must pull messages themselves. This rules out pure tmux injection as a reliable mechanism.\n\n## Decision\n\n**Integrate claude-dashboard with mcp_agent_mail (https://github.com/Dicklesworthstone/mcp_agent_mail) as the agent communication layer.**\n\nmcp_agent_mail provides:\n- Agent identity and registration per project\n- Threaded inbox/outbox via MCP tools (`send_message`, `fetch_inbox`, `acknowledge_message`)\n- File reservations (leases) to prevent editing conflicts in shared repos\n- SQLite + Git persistence (human-readable, auditable)\n- Web UI for humans to monitor message flow\n\nThe polling problem is solved by CLAUDE.md: each session's scaffolded CLAUDE.md instructs the agent to register with the mail server and check its inbox at session start and at natural task boundaries. No push required.\n\n## Architecture\n\n```\nmcp_agent_mail server (FastMCP over HTTP)\n        ‚îÇ\n        ‚îú‚îÄ‚îÄ claude session A (registered as \"GreenCastle\")\n        ‚îÇ     reads: CLAUDE.md ‚Üí \"check inbox at task start\"\n        ‚îÇ     tools: fetch_inbox, send_message, file_reservation_paths\n        ‚îÇ\n        ‚îú‚îÄ‚îÄ claude session B (registered as \"BlueTower\")\n        ‚îÇ     same CLAUDE.md instructions\n        ‚îÇ\n        ‚îî‚îÄ‚îÄ codex session C (registered as \"RedFalcon\")\n              same protocol, agent-agnostic\n```\n\nclaude-dashboard role:\n- Optionally start/manage the mcp_agent_mail server process\n- Inject MCP server config into each new session's environment\n- Scaffold CLAUDE.md with agent registration + inbox check instructions\n- Show message activity in session detail view (`d` key)\n\n## Message Threading + Beads Integration\n\nmcp_agent_mail organizes messages into threads by task ID. Using beads issue IDs as thread IDs (e.g., `claude-dashboard-88i`) means:\n- Agent conversations are naturally linked to the work item\n- Humans can see the full context: bead + messages + code changes\n- No separate tracking overhead\n\n## File Reservation Integration\n\nFor shared-repo sessions (multiple agents on the same codebase without worktrees), file reservations prevent conflicts:\n- Agent claims a lease on `internal/session/manager.go` before editing\n- Other agents see the reservation and work on different files\n- Dashboard could surface active reservations in the session list\n\n## Alternatives Considered\n\n1. **tmux SendKeys injection** ‚Äî rejected: unreliable, agent may be mid-task, no persistence\n2. **Shared file mailbox** ‚Äî valid for simple cases but no discovery, no threading, no file coordination\n3. **Build our own MCP server** ‚Äî rejected: mcp_agent_mail already solves this well and aligns with beads\n\n## Status\nACCEPTED ‚Äî pending implementation (see feature bead)","status":"open","priority":2,"issue_type":"decision","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T07:25:07Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T07:25:07Z","dependencies":[{"issue_id":"claude-dashboard-71j","depends_on_id":"claude-dashboard-hpy","type":"relates-to","created_at":"2026-02-21T12:55:18Z","created_by":"Lakshmi Narasimhan","metadata":"{}"}]}
{"id":"claude-dashboard-876","title":"feat: multi-host support - manage remote tmux sessions via SSH","description":"## Overview\n\nCurrently claude-dashboard only manages tmux sessions on the local machine. This feature would allow managing sessions on remote machines/VMs over SSH, enabling a single dashboard instance to orchestrate Claude Code agents across multiple hosts.\n\n## Use Case\n\n- Spin up Claude Code instances on a powerful remote VM or cloud instance\n- Control and monitor all sessions from a local claude-dashboard instance\n- Useful for: resource-intensive tasks, parallel agents on dedicated machines, team setups\n\n## How It Would Work\n\nEach session config gets an optional host field:\n```yaml\nsessions:\n  - name: auth-refactor\n    host: user@remote-vm  # optional, defaults to local\n    path: ~/projects/myapp\n```\n\nDashboard runs tmux commands via SSH for remote sessions:\n- Local: `tmux new-session ...`\n- Remote: `ssh user@remote tmux new-session ...`\n\nOutput streaming (for session detail view) via `ssh user@remote tmux capture-pane ...`\n\n## Challenges\n- SSH auth (keys, agents, jump hosts)\n- Latency on tmux capture for live output\n- mcp_agent_mail: remote agents need to reach the mail server (or run one per host)\n- Session detection: listing remote sessions on startup\n\n## Current Workaround\nRun claude-dashboard directly on the remote machine via SSH. Local terminal is just the display. Works today, zero changes needed.\n\n## Priority\nLow ‚Äî workaround is sufficient for single-user setups. Becomes valuable for team use or dedicated agent VMs.","status":"open","priority":4,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T13:13:35Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T13:13:35Z"}
{"id":"claude-dashboard-88i","title":"feat: worktree and env setup support for session creation","description":"## Overview\n\nTwo independent, opt-in features added to the session creation flow (both TUI `n` key and CLI `cdn`):\n\n1. **Create worktree?** ‚Äî optionally create a git worktree for this session\n2. **Setup new env?** ‚Äî optionally scaffold a new environment using `.claude/worktree-setup.md`\n\nThese are decoupled. You can have a worktree without env setup, env setup without a worktree, both, or neither.\n\n---\n\n## Feature 1: Worktree Creation\n\n### TUI Changes\nAdd a third field to the create session form:\n```\n‚ñ∏ Name:       my-feature\n  Directory:  /Users/you/code/myrepo\n  Worktree?   [y/n]\n  New env?    [y/n]\n```\n\n### CLI Changes\n```bash\ncdn my-feature --path ~/code/myrepo --worktree\ncdn my-feature --path ~/code/myrepo --new-env\ncdn my-feature --path ~/code/myrepo --worktree --new-env\n```\n\n### Behavior\n- Run `git worktree add \u003cworktree-path\u003e -b \u003csession-name\u003e` where session-name = tmux session name without `cd-` prefix\n- Worktree location: sibling directory `../worktrees/\u003csession-name\u003e` relative to project root (configurable via `worktree_base` in config.yaml)\n- Start claude session in the worktree path instead of the repo root\n- If not a git repo: warn and proceed without creating worktree\n- If branch already exists: reuse it (no `-b` flag)\n- If worktree already exists: reuse it\n\n### Naming Convention\n| Thing | Value |\n|---|---|\n| Session | `cd-my-feature` |\n| Branch | `my-feature` |\n| Worktree path | `~/code/worktrees/my-feature` |\n\n### Kill Behavior\nWhen killing a session that has an associated worktree, ask:\n`Delete worktree too? [y/n]`\n\n### Config Addition\n```yaml\nworktree_base: ''   # default: ../worktrees/ relative to project root\n```\n\n---\n\n## Feature 2: Env Setup\n\n### Behavior\n- Check if `.claude/worktree-setup.md` exists in the project directory\n- If yes: scaffold a `CLAUDE.md` in the session directory with instructions to read and execute the setup file\n- If no setup file exists: scaffold a minimal `CLAUDE.md` with just session metadata\n- Check for `.claude/worktree-teardown.md` too; reference it in CLAUDE.md if found\n- Works independently of worktree ‚Äî can be used in a plain session too\n\n### Scaffolded CLAUDE.md (when setup.md exists)\n```markdown\n# Session: my-feature\nBranch: my-feature\nCreated: 2026-02-21\n\n## Setup\nBefore starting work, read and execute the steps in: `.claude/worktree-setup.md`\n\n## Teardown\nWhen done with this session, read and execute: `.claude/worktree-teardown.md` (if it exists)\n```\n\n### Repo-owned setup files\nPlain markdown task lists written by devs, executed by the agent. No shell scripts.\n\nExample `.claude/worktree-setup.md`:\n```markdown\n# Worktree Setup\n1. Clone the staging DB to `./db-snapshots/local` using creds from `.env.example`\n2. Run `docker compose up -d` on port 5433 (not 5432 to avoid conflicts)\n3. Start ngrok pointing to port 3000 and save tunnel URL to `.ngrok-url`\n4. Run `npm install`\n```\n\nNot all worktrees need env setup ‚Äî this is fully opt-in per session.\n\n---\n\n## Implementation Plan\n\n### New: `internal/worktree/` package\n- `Create(repoPath, branchName, worktreeBase string) (worktreePath string, error)`\n- `Remove(worktreePath string) error`\n- `Exists(worktreePath string) bool`\n- `IsGitRepo(path string) bool`\n\n### New: `internal/envsetup/` package\n- `ScaffoldCLAUDEMd(sessionDir, sessionName, branchName string) error`\n  - Checks for `.claude/worktree-setup.md` and `.claude/worktree-teardown.md`\n  - Writes appropriate `CLAUDE.md`\n\n### `internal/ui/create.go`\n- Add `WorktreeToggle bool` and `EnvToggle bool` to `CreateForm`\n- Add y/n toggle rendering for both fields\n- Tab cycles through all four fields\n\n### `internal/session/manager.go`\n- `Create()` gains `worktree bool` and `newEnv bool` params\n- Calls worktree.Create() if worktree=true\n- Calls envsetup.ScaffoldCLAUDEMd() if newEnv=true\n- Uses worktree path as session start directory if worktree was created\n\n### `internal/session/session.go`\n- Add `WorktreePath string` field for cleanup on kill\n\n### `internal/app/app.go`\n- `createSession()` passes worktree and env booleans from form\n- Kill flow: if session has WorktreePath, add delete worktree prompt\n\n### `cmd/claude-dashboard/main.go`\n- Parse `--worktree` and `--new-env` flags\n\n### `internal/config/config.go`\n- Add `WorktreeBase string` field (default: empty = sibling ../worktrees/)\n\n---\n\n## Edge Cases\n\n| Case | Behavior |\n|---|---|\n| Not a git repo | Skip worktree creation, warn, proceed |\n| Branch already exists | `git worktree add` without `-b` |\n| Worktree dir already exists | Reuse, skip creation |\n| No `.claude/worktree-setup.md` | Scaffold minimal CLAUDE.md |\n| Both worktree + env | Scaffold CLAUDE.md in worktree root |\n| Env only, no worktree | Scaffold CLAUDE.md in project root |\n| Kill with worktree | Prompt delete worktree y/n |","status":"open","priority":2,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T07:00:47Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T07:00:47Z","dependencies":[{"issue_id":"claude-dashboard-88i","depends_on_id":"claude-dashboard-hpy","type":"relates-to","created_at":"2026-02-21T12:55:18Z","created_by":"Lakshmi Narasimhan","metadata":"{}"}]}
{"id":"claude-dashboard-bt5","title":"ux: path autocomplete with tab in new session form","description":"## Overview\n\nWhen creating a new session via the TUI (`n` key), the Directory field requires typing a full path manually. This bead adds **filesystem path autocomplete** triggered by `Tab` in the Directory input field.\n\n---\n\n## Current Behavior\n- User types full path manually: `/Users/lakshminp/growthwriter/gw-backend`\n- No autocomplete, no directory listing\n- `Tab` currently cycles between Name and Directory fields\n\n---\n\n## Proposed Behavior\n- While typing in the Directory field, pressing `Tab` completes the current path segment\n- If multiple matches exist, cycles through them or shows a small picker below the field\n- `Shift+Tab` cycles backwards through matches (or moves focus back to Name field if no match)\n- `Enter` confirms selection and submits the form\n\n---\n\n## Autocomplete Behavior\n\n### Single match\n```\n  Directory: /Users/lakshminp/grow[Tab]\n  ‚Üí /Users/lakshminp/growthwriter/\n```\n\n### Multiple matches\n```\n  Directory: /Users/lakshminp/c[Tab]\n  ‚Üí shows picker:\n      claude-tools/\n      carnatic/\n```\n  Tab cycles through options, Enter selects\n\n### Tilde expansion\n```\n  Directory: ~/grow[Tab]\n  ‚Üí ~/growthwriter/\n```\n  `~` is expanded for filesystem lookup but displayed as `~` in the field\n\n### Auto-append slash\nWhen completing to a directory, automatically append `/` so next Tab continues completing the next segment.\n\n---\n\n## UX Details\n\n### Picker display (multiple matches)\nSmall inline picker below the Directory field, max 5 entries:\n```\n  ‚ñ∏ Directory:  /Users/lakshminp/c\n  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n  ‚îÇ \u003e claude-tools/             ‚îÇ\n  ‚îÇ   carnatic/                 ‚îÇ\n  ‚îÇ   claude-smallbets/         ‚îÇ\n  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n  Tab/‚Üë‚Üì to cycle ¬∑ Enter to select\n```\n\n### Tab key conflict resolution\nCurrently Tab moves focus between Name and Directory fields.\n**Proposed**: Tab in Directory field triggers autocomplete first. Only if no partial path is typed (field is empty) does Tab move focus back to Name. Shift+Tab always moves focus back to Name.\n\n---\n\n## Implementation Notes\n\n### New: `internal/ui/pathcomplete.go`\n- `Complete(partial string) []string` ‚Äî returns filesystem matches for partial path\n- Expands `~` for lookup\n- Lists directories only (not files, since we want project directories)\n- Sorts results alphabetically\n\n### Changes to `internal/ui/create.go`\n- Add `completions []string` and `completionIdx int` to `CreateForm`\n- Add `ShowPicker bool` state\n- `HandleTab()` method ‚Äî triggers completion or cycles\n- Update `Validate()` to handle mid-completion state\n- Update `RenderCreateForm()` to render picker when `ShowPicker` is true\n\n### Changes to `internal/app/app.go` (`handleCreateKey`)\n- Route `tab` key to `CreateForm.HandleTab()` when Directory is focused\n- Route `shift+tab` to move focus back to Name always\n\n---\n\n## Acceptance Criteria\n- [ ] Tab in Directory field completes the current path segment\n- [ ] Single match: completes inline\n- [ ] Multiple matches: shows picker, Tab cycles through\n- [ ] `~` works in path input and is expanded for filesystem lookup\n- [ ] Enter confirms and submits form\n- [ ] Shift+Tab always moves focus back to Name field\n- [ ] Only directories shown (not files)\n- [ ] Max 5 completions shown in picker","status":"open","priority":2,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T10:35:59Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T10:35:59Z"}
{"id":"claude-dashboard-hpy","title":"feat: integrate mcp_agent_mail for agent-to-agent messaging","description":"## Overview\n\nIntegrate claude-dashboard with mcp_agent_mail to enable agent-to-agent communication across sessions.\n\nReference: https://github.com/Dicklesworthstone/mcp_agent_mail\nArchitecture decision: (decision bead to be linked)\n\n---\n\n## How It Works\n\nAgents cannot receive pushed messages ‚Äî they must poll. The solution:\n1. Run mcp_agent_mail as a local MCP server\n2. Scaffold each session's CLAUDE.md with instructions to register and check inbox\n3. Agents use MCP tools (`fetch_inbox`, `send_message`) at natural task boundaries\n\nNo injection, no polling daemon needed ‚Äî the agent itself handles it.\n\n---\n\n## Implementation Plan\n\n### Phase 1: Manual setup (zero dashboard code changes)\n- User runs mcp_agent_mail server manually\n- claude-dashboard's CLAUDE.md scaffolding (from env setup feature, claude-dashboard-88i) includes agent mail instructions when `--new-env` is used\n- Users can test the workflow end-to-end\n\nScaffolded CLAUDE.md addition:\n```markdown\n## Agent Communication\nAn MCP agent mail server is running at http://localhost:8765\nOn session start:\n1. Register yourself: call `register_agent` with project=\u003cproject-name\u003e\n2. Check your inbox: call `fetch_inbox` to see pending messages\n3. Before editing any file, reserve it: call `file_reservation_paths`\n4. Check inbox again when completing each major task\n```\n\n### Phase 2: Dashboard manages the server\n- Config option to auto-start mcp_agent_mail server:\n```yaml\n# ~/.claude-dashboard/config.yaml\nagent_mail:\n  enabled: true\n  port: 8765\n  data_dir: ~/.claude-dashboard/agent-mail/\n```\n- Dashboard starts the server on launch if enabled\n- Dashboard stops it on quit\n- Session creation auto-injects MCP config into the tmux session environment\n\n### Phase 3: Dashboard surfaces message activity\n- Session list shows unread message count badge\n- Session detail (`d` key) shows recent inbox messages\n- New view (`m` key?): message thread browser across all sessions\n- File reservation conflicts shown as warnings in session list\n\n---\n\n## CLAUDE.md Integration\n\nWorks alongside the env setup feature (claude-dashboard-88i). When `--new-env` is used and agent mail is enabled in config, scaffold includes agent mail instructions automatically.\n\n---\n\n## Beads Thread Integration\n\nUse beads issue IDs as mcp_agent_mail thread IDs. When an agent starts work on a bead:\n- Thread ID = bead ID (e.g., `claude-dashboard-88i`)\n- All agent messages about that task are grouped together\n- Humans get full context: bead + messages + commits\n\n---\n\n## File Reservation for Shared Repos\n\nWhen multiple sessions work on the same repo (no worktrees):\n- Agents claim file leases before editing\n- Dashboard warns if two sessions have conflicting reservations\n- Surface in session list or detail view\n\n---\n\n## Dependencies\n- mcp_agent_mail server (Python, FastMCP)\n- Agents must have the MCP server configured in their MCP settings\n- Works with any agent that supports MCP (Claude, Codex with MCP support, etc.)\n\n---\n\n## Open Questions\n1. Should the dashboard embed mcp_agent_mail or just manage an external process?\n2. How to auto-configure MCP server URL in each tmux session for different agents?\n3. Agent naming: auto-generate (adjective-noun) or use session name?","notes":"## Setup (Phase 1 ‚Äî Completed 2026-02-21)\n\n### mcp_agent_mail Installation\n- Repo: ~/claude-tools/mcp_agent_mail\n- Python venv: ~/claude-tools/mcp_agent_mail/.venv (Python 3.12 ‚Äî NOT 3.14, pydantic incompatible)\n- LaunchAgent: ~/Library/LaunchAgents/com.lakshminp.mcp-agent-mail.plist (auto-starts on login)\n- Server: http://127.0.0.1:8765\n- Bearer token: in ~/.claude/settings.json ‚Üí mcpServers.mcp-agent-mail.headers.Authorization\n- Logs: /tmp/mcp-agent-mail.log\n- Web UI: http://127.0.0.1:8765/mail\n\n### Claude Code Integration\n- MCP server in ~/.claude/settings.json (done by mcp_agent_mail installer)\n- Agent instructions in ~/.claude/CLAUDE.md (done by claude-dashboard setup)\n- Agents skip silently if server unreachable\n\n### Server Management\n  launchctl start com.lakshminp.mcp-agent-mail\n  launchctl stop com.lakshminp.mcp-agent-mail\n  tail -f /tmp/mcp-agent-mail.log\n  open http://127.0.0.1:8765/mail\n\n### Installer Gotchas\n- Run installer from OUTSIDE the target repo (it clones into cwd)\n- Installer renames bd to bd.old and adds bd alias to br in ~/.zshrc ‚Äî restore with: cp ~/.local/bin/bd.old ~/.local/bin/bd\n- Use Python 3.12 not 3.14","status":"in_progress","priority":3,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T07:25:07Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T13:44:36Z","dependencies":[{"issue_id":"claude-dashboard-hpy","depends_on_id":"claude-dashboard-71j","type":"relates-to","created_at":"2026-02-21T12:55:18Z","created_by":"Lakshmi Narasimhan","metadata":"{}"},{"issue_id":"claude-dashboard-hpy","depends_on_id":"claude-dashboard-88i","type":"relates-to","created_at":"2026-02-21T12:55:18Z","created_by":"Lakshmi Narasimhan","metadata":"{}"}]}
{"id":"claude-dashboard-ihq","title":"feat: multi-agent support (codex, aider, and others)","description":"## Overview\n\nCurrently claude-dashboard hardcodes `claude` as the agent command launched in every tmux session. This issue tracks making the agent configurable so the dashboard works with any AI coding agent (Codex, Aider, Continue, etc.).\n\n---\n\n## Motivation\n\n- Users may want to run Codex CLI (`codex`) or Aider (`aider`) sessions alongside or instead of Claude sessions\n- The dashboard's session management, monitoring, and worktree features are agent-agnostic\n- A user might mix agents across sessions (one session with claude, another with codex)\n\n---\n\n## Proposed Changes\n\n### Config: default agent\n```yaml\n# ~/.claude-dashboard/config.yaml\ndefault_agent: claude   # or: codex, aider, custom binary name\n```\n\n### CLI: per-session agent override\n```bash\ncdn my-feature --agent codex\ncdn my-feature --agent aider --path ~/code/myrepo\ncdn my-feature --agent claude   # explicit, same as default\n```\n\n### TUI: agent field in create form\n```\n  Name:       my-feature\n  Directory:  /Users/you/code/myrepo\n‚ñ∏ Agent:      claude         ‚Üê dropdown or free-text, defaults to config value\n  Worktree?   [y/n]\n  New env?    [y/n]\n```\n\n---\n\n## Agent Command Construction\n\nCurrently hardcoded in `internal/session/manager.go`:\n```go\ncommand := \"claude\"\nif claudeArgs != \"\" {\n    command = \"claude \" + claudeArgs\n}\n```\n\nReplace with:\n```go\nagent := cfg.DefaultAgent   // falls back to \"claude\"\nif agentOverride != \"\" {\n    agent = agentOverride\n}\ncommand := agent\nif claudeArgs != \"\" {\n    command = agent + \" \" + claudeArgs\n}\n```\n\n---\n\n## Session Detection\n\nCurrently the detector looks for sessions with `cd-` prefix OR `claude` in the name OR a `claude` process in the process tree.\n\nChanges needed:\n- Detection by `cd-` prefix remains the primary signal (agent-agnostic)\n- Process tree detection: scan for any known agent binary, not just `claude`\n- Store the agent name on the `Session` struct for display in the dashboard\n- Show agent name in session detail view (`d` key)\n\n### Known agents to detect\n- `claude` (Claude Code)\n- `codex` (OpenAI Codex CLI)\n- `aider` (Aider)\n- Any binary specified in config\n\n---\n\n## Session Struct Change\n```go\ntype Session struct {\n    // ... existing fields ...\n    Agent string   // e.g. \"claude\", \"codex\", \"aider\"\n}\n```\n\nShow in detail view and optionally as a column or badge in the main table.\n\n---\n\n## Implementation Plan\n\n### `internal/config/config.go`\n- Add `DefaultAgent string` (default: `\"claude\"`)\n\n### `internal/session/manager.go`\n- `Create()` gains `agent string` param\n- Use agent from param, fall back to config default\n\n### `internal/session/detector.go`\n- Expand process detection to check for known agent binaries\n- Store detected agent name on Session struct\n\n### `internal/session/session.go`\n- Add `Agent string` field\n\n### `internal/ui/create.go`\n- Add Agent field to CreateForm (text input, pre-filled with config default)\n\n### `internal/app/app.go`\n- Pass agent from form to createSession()\n\n### `cmd/claude-dashboard/main.go`\n- Parse `--agent \u003cname\u003e` flag in `new` subcommand\n\n---\n\n## Edge Cases\n\n| Case | Behavior |\n|---|---|\n| Agent binary not found in PATH | Warn at session creation time |\n| Unknown agent process detected | Show as agent name in session list |\n| `default_args` with non-claude agent | Pass args as-is; user's responsibility |\n| Mixing agents across sessions | Fully supported, per-session override |\n\n---\n\n## Notes\n- The `--dangerously-skip-permissions` flag is Claude-specific; users should not pass it when using other agents. The `default_args` config should be agent-aware or documented accordingly.\n- Worktree and env setup features (claude-dashboard-88i) are fully agent-agnostic and work unchanged.","status":"open","priority":2,"issue_type":"feature","owner":"badri.dilbert@gmail.com","created_at":"2026-02-21T07:10:13Z","created_by":"Lakshmi Narasimhan","updated_at":"2026-02-21T07:10:13Z","dependencies":[{"issue_id":"claude-dashboard-ihq","depends_on_id":"claude-dashboard-hpy","type":"blocks","created_at":"2026-02-21T12:55:13Z","created_by":"Lakshmi Narasimhan","metadata":"{}"}]}
